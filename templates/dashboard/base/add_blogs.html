{% load static %}

<div class="col-md-9">
    <div class="card shadow">
        <div class="card-header bg-dark text-light">
            <h4 class="mb-0">Add New Blog</h4>
        </div>
        <div class="card-body">
            <form method="POST" enctype="multipart/form-data">
                {% csrf_token %}

                <!-- Title -->
                <div class="mb-3">
                    <label class="form-label">Title</label>
                    <input type="text" name="title" class="form-control" required>
                </div>

                <!-- SubCategory -->
                <div class="mb-3">
                    <label class="form-label">SubCategory</label>
                    <select name="subcategory" class="form-select" required>
                        <option value="">-- Select SubCategory --</option>
                        {% for sub in subcategories %}
                            <option value="{{ sub.id }}">{{ sub.category.category_name }} - {{ sub.name }}</option>
                        {% endfor %}
                    </select>
                </div>

                <!-- Short Description -->
                <div class="mb-3">
                    <label class="form-label">Short Description</label>
                    <textarea name="short_description" class="form-control" rows="3" maxlength="1000"></textarea>
                </div>

                <!-- Blog Body (CKEditor) -->
                <div class="mb-3">
                    <label class="form-label">Blog Body</label>
                    <textarea name="blog_body" id="id_blog_body" class="form-control" rows="10"></textarea>
                </div>

                <!-- Thumbnail -->
                <div class="mb-3">
                    <label class="form-label">Thumbnail</label>
                    <input type="file" name="blog_image" class="form-control">
                </div>

                <!-- Featured -->
                <div class="form-check mb-3">
                    <input type="checkbox" name="is_featured" class="form-check-input" id="featured">
                    <label for="featured" class="form-check-label">Featured</label>
                </div>

                <!-- Status -->
                <div class="mb-3">
                    <label class="form-label">Status</label>
                    <select name="status" class="form-select">
                        <option value="draft">Draft</option>
                        <option value="published">Published</option>
                    </select>
                </div>

                <button type="submit" class="btn btn-primary">Save Blog</button>
                <a href="{% url 'blogs' %}" class="btn btn-secondary">Cancel</a>
            </form>
        </div>
    </div>
</div>




<script src="https://cdn.ckeditor.com/ckeditor5/39.0.0/classic/ckeditor.js"></script>
<script>
ClassicEditor
.create(document.querySelector('#id_blog_body'), {
    ckfinder: {
        uploadUrl: "{% url 'upload_image' %}"
    }
})
.then(editor => {
    // Sync dữ liệu trước submit
    document.querySelector('form').addEventListener('submit', function() {
        document.querySelector('#id_blog_body').value = editor.getData();
    });
})
.catch(error => { console.error(error); });
</script>





